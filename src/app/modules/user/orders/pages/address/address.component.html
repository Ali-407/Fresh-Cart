<div class="max-w-md mx-auto my-10 border border-gray-200 shadow-lg shadow-indigo-400 p-5 rounded-lg bg-gray-50">

    <div class="bg-gradient-to-r from-indigo-600 to-blue-500 rounded-md">
        <h1 class="font-bold mb-5 text-center pb-1 text-white text-xl">Address Now:</h1>
    </div>

    <form [formGroup]="addressForm" (ngSubmit)="getValues()">

        <div>
            <!-- Address Details -->
            <div>
                <h3 class="pb-1 text-gray-700">Address Details</h3>
                <textarea formControlName="details" type="text"
                    class="w-full border py-1 rounded-sm focus:ring-2 focus:ring-indigo-400 px-2"
                    placeholder="Enter details"></textarea>
                <app-error-message [control]="addressForm.get('details')"></app-error-message>
            </div>

            <!-- Phone Number -->
            <div class="relative mt-4">
                <h3 class="pb-1 text-gray-700">Enter Your Phone</h3>
                <input formControlName="phone" type="tel"
                    class="w-full border py-1 rounded-sm focus:ring-2 focus:ring-indigo-400 px-2"
                    placeholder="Example: 01012345678">
                
                <!-- Custom Phone Validation Messages -->
                @if (addressForm.get('phone')?.errors && addressForm.get('phone')?.touched) {
                <div class="bg-indigo-100 border border-indigo-400 text-indigo-600 px-4 py-3 rounded relative mt-2">
                    <ul>
                        @if (addressForm.get('phone')?.getError('required')) {
                        <li>
                            <i class="fa-solid fa-circle-exclamation mr-1"></i> Phone number is required
                        </li>
                        }
                        @if (addressForm.get('phone')?.getError('pattern')) {
                        <li>
                            <i class="fa-solid fa-circle-exclamation mr-1"></i> Valid Egyptian phone number required
                        </li>
                        <li class="text-sm mt-1 ml-5">
                            • Must start with 010, 011, 012, or 015
                        </li>
                        <li class="text-sm ml-5">
                            • Must be 11 digits (e.g., 01012345678)
                        </li>
                        }
                    </ul>
                </div>
                }
            </div>

            <!-- City -->
            <div class="relative mt-4">
                <h3 class="pb-1 text-gray-700">Enter Your City</h3>
                <input formControlName="city" type="text"
                    class="w-full border py-1 rounded-sm focus:ring-2 focus:ring-indigo-400 px-2"
                    placeholder="Enter city">
                <app-error-message [control]="addressForm.get('city')"></app-error-message>
            </div>
        </div>

        <button [disabled]="isloading"
            class="w-full bg-indigo-600 hover:bg-indigo-700 text-white rounded-md shadow-md py-2 mt-4 transition">
            
            @if(!isloading){
                Confirm Order
            }@else {
                loading...
            }
        </button>

        @if (errorMsg) {
        <div class="bg-indigo-100 border border-indigo-400 text-indigo-600 px-4 py-3 rounded relative mt-2">
            {{errorMsg}}
        </div>
        }

    </form>
</div>